<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Edu-File</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
</head>
<body>
    <nav class="navbar">
    <div class="logo">
        <img src="{{ url_for('static', filename='edulogo.png') }}" alt="Logo" style="height:35px; vertical-align:middle; margin-right:8px;">
    </div>
    <div class="nav-links">
        <a href="#">
        <img src="{{ url_for('static', filename='home.png') }}" alt="Home" style="height:20px; vertical-align:middle; position: relative; top: -3px; margin-left: -37px;">   
        <span style="position:relative; left: -6px;">HOME</span>
    </a>
        <a href="#">
        <img src="{{ url_for('static', filename='book.png') }}" alt="Subject" style="height:42px; vertical-align:middle; position: relative; margin-left: -37px;">    
        <span style="position:relative; left: -16px;">SUBJECT</span>
    </a>
        <a href="#">
        <img src="{{ url_for('static', filename='set.png') }}" alt="Setting" style="height:20px; vertical-align:middle; position: relative; top: -2px; margin-left: -37px;">    
        <span style="position:relative; left: -5px;">SETTING</span>
    </a>
    </div>
    <div class="user-menu">
        <i class="fa fa-user"></i> UNAME
    </div>    
</nav>
    <div class="container">
        <div class="form-header">
    <i class="fa fa-user"></i> UNAME
</div>
        <form class="post-form" method="post" enctype="multipart/form-data">
            <textarea id="summary-textarea" name="summary" placeholder="พิมพ์ข้อความสรุป..." required></textarea>
            <div class="file-upload-box">
  <input type="file" id="file-upload" name="file" accept=".pdf,image/*" hidden>
  <label for="file-upload" class="custom-file-label">
    <img src="{{ url_for('static', filename='z.png') }}" alt="file icon" style="height: 22px; vertical-align: middle; margin-right: -3px;">
    เลือกไฟล์
</label>
  <span id="file-name" class="file-name-label">ไม่มีไฟล์ที่เลือก</span>
</div>
            <button type="submit">POST!</button>
        </form>
        <div class="posts">
            {% for post in posts %}
            <div class="post">
                <div class="post-header">
                    <span class="post-header">UNAME</span>
                </div>
                <div class="post-content">
                    <div class="post-text">{{ post.text|e }}</div>
                    {% if post.file %}
                        <div class="post-file">
                            {% if post.file.endswith('.pdf') %}
                                <a href="{{ url_for('static', filename='uploads/' + post.file) }}" target="_blank">
                                    <img src="https://cdn.jsdelivr.net/gh/walkxcode/dashboard-icons/svg/file-pdf.svg" alt="PDF" class="file-icon">
                                    {{ post.file }}
                                </a>
                            {% else %}
                                <img src="{{ url_for('static', filename='uploads/' + post.file) }}" alt="แนบไฟล์" class="attached-img">
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
                <div class="post-actions">
                    <a href="{{ url_for('share', post_id=post.id) }}" target="_blank" class="share-btn">แชร์</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
<script>
const textarea = document.getElementById('summary-textarea');
textarea.addEventListener('input', function() {
    this.style.height = 'auto';
    this.style.height = (this.scrollHeight) + 'px';
});
document.getElementById('file-upload').addEventListener('change', function() {
    const fileName = this.files[0] ? this.files[0].name : 'ไม่มีไฟล์ที่เลือก';
    const icon = `<img src="{{ url_for('static', filename='q.png') }}" alt="file icon" style="height: 30px; vertical-align: middle; margin-right: -3px;">`;
    document.getElementById('file-name').innerHTML = fileName !== 'ไม่มีไฟล์ที่เลือก'
        ? icon + '<b>' + fileName + '</b>'
        : 'ไม่มีไฟล์ที่เลือก';
});
</script>
</body>
</html>